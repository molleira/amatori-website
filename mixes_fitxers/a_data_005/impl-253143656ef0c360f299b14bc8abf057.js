!function(){"use strict";var e,t;const n=Symbol("queue"),i=Symbol("pageViewCallbacks"),r=Symbol("pageViewProps"),s=Symbol("timeout");const o=JSON.parse(document.currentScript.dataset.recordUrl),c=1e3*JSON.parse(document.currentScript.dataset.sendDelay),a=JSON.parse(document.currentScript.dataset.enabled),d=new class{constructor(e,t,s){this.recordURL=e,this.sendDelay=t,this.enabled=s,this[n]=[],this[i]=[];const o=()=>{if(this[r])return;const e={referrer_url:document.referrer,screen:{width:window.screen.width,height:window.screen.height,density:window.devicePixelRatio}};window.MediaView&&window.MediaView.mode&&(e.media_mode=window.MediaView.mode);const t=document.head.querySelectorAll('meta[name="bc-page-properties"]');for(let n of t)Object.assign(e,JSON.parse(n.content));this[r]=e,this.record("page_view",e),this[i].forEach((t=>t(e))),delete this[i]};document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState&&o(),"visible"!==document.visibilityState&&this.send()})),window.addEventListener("pagehide",(()=>{this.send()})),"visible"===document.visibilityState&&o()}record(e,t){this[n].push({type:e,timestamp:Date.now()/1e3,properties:Object.assign({page_url:location.href},t)}),this[s]||(this[s]=setTimeout((()=>this.send()),this.sendDelay))}send(){this[s]&&(clearTimeout(this[s]),this[s]=null);const e=this[n];if(0===e.length)return void console.log("no events to send");if(!this.enabled)return console.log("Tracker disabled; not sending events:",e),void(e.length=0);console.log("sending "+e.length+" tracking events");const t=JSON.stringify({send_time:Date.now()/1e3,events:e});navigator.sendBeacon(this.recordURL,t)?e.length=0:console.warn("failed to queue sendBeacon for events",this.queue)}afterPageView(e){this[r]?e(this[r]):this[i].push(e)}}(o,c,a),l=(null===(e=window.BCTracker)||void 0===e?void 0:e.preloadQueue)||[];for(let e of l)d.record.apply(d,e);const h=(null===(t=window.BCTracker)||void 0===t?void 0:t.prePageViewCallbacks)||[];for(let e of h)d.afterPageView(e);window.BCTracker=d}(),function(){"use strict";if(JSON.parse(document.currentScript.dataset.autoTrackClicks)){JSON.parse(document.currentScript.dataset.autoTrackFilters);document.addEventListener("click",(function(e){var t=e.target;"a"===t.localName&&t.host&&t.host!==location.host&&!t.host.endsWith("bandcamp.com")&&BCTracker.record("click",{tag:"external_link",link_url:e.target.href})}),{capture:!0,passive:!0})}}(),function(){"use strict";function e(e){"IntersectionObserver"in window?(this.intersectionObserver=new IntersectionObserver(this.observeIntersections.bind(this),e),this.elemProps={}):console.warn("IntersectionObserver not available")}e.prototype.observeIntersections=function(e){var t=this;e.forEach((function(e){if(e.isIntersecting){var n=e.target,i=t.elemProps[n];BCTracker.record("scroll",i),delete t.elemProps[n],t.intersectionObserver.unobserve(n)}}))},e.prototype.track=function(e,t){this.intersectionObserver&&(this.elemProps[e]=t,this.intersectionObserver.observe(e))};var t;e.track=function(n,i){t||(t=new e({threshold:.25})),t.track(n,i)},window.ScrollDepthTracker=e}(),function(){"use strict";const e=/\.?bandcamp\.com$|\.bcbits.com$|\.bcdevs.com$/i;let t=!1;document.addEventListener("DOMContentLoaded",(()=>t=!0)),window.addEventListener("error",(n=>{try{const i=n.filename&&new URL(n.filename);if(i.hostname&&!e.test(i.hostname))return;BCTracker.record("performance",{subtype:"js_error",message:n.message,filename:n.filename,lineno:n.lineno,colno:n.colno,dom_ready:t})}catch(e){console.error(e)}}))}();
